services:
  resourceserver:
    image: kennethreitz/httpbin

  apigateway:
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      AUTH_SERVER: authserver:8080
      RESOURCE_SERVER: resourceserver:80
    ports:
      - "8080:8080"

  authserver:
    image: jboss/keycloak
    ports:
      - "8081:8080"
    volumes:
      - keycloak_data:/opt/jboss/keycloak/standalone/data
    environment:
      KEYCLOAK_USER: admin
      KEYCLOAK_PASSWORD: admin

volumes:
  keycloak_data:
